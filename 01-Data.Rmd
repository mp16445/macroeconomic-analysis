# Long-run growth trends in GDP {#LRG}

-------------------------------------------------------------------------------------

In this chapter, we will:

- Define *growth rates* and show how to calculate them.
- Explain the importance of *compounding* effects in modern growth trends.
- Show the power of *logarithm* plots and *logarithm (ratio) scales*.
- Describe the main trends in GDP (and population) growth over time and across countries.
- Perform basic operations, construct plots and tables in Excel.

We will assume that you know what GDP represents, how it is constructed and its limitations. We will use data from the <a href="https://www.rug.nl/ggdc/historicaldevelopment/maddison/releases/maddison-project-database-2023" target="_blank">*Maddison Project Database 2023*</a> [@BJZL_2024] and the <a href="https://www.rug.nl/ggdc/productivity/pwt/" target="_blank">*Penn World Table*</a> [@PWT], which allow us to compare *real* economic outcomes over time and across countries. GDP in this chapter will always refer to real GDP although this may not be explicitly mentioned for simplicity in the text.

Although this chapter has been conceived to be read in one go, some sections can be used as a reference point to check more technical details at later stages. Indeed some of the concepts may make more sense after having worked with the data.

-------------------------------------------------------------------------------------

## Introduction

```{r mpdplot1, echo=FALSE, fig.align='center', fig.cap= "Long-run trends in GDP per capita: 1700-2022", warning=FALSE}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% select(country, year, gdppc) %>% filter(country == "United Kingdom" | country == "United States" | country == "China" | country == "Nigeria" | country == "Japan" | country == "Brazil" | country == "South Africa" | country == "Indonesia" | country == "India" | country == "France" | country == "Germany" | country == "Russian Federation" | country == "Turkey" | country == "Italy" | country == "Mexico", year >= 1700) 
dates <- seq(from = 1700, to = 2022, by = 30)

mpd2023 %>% ggplot(aes(x = year, y = gdppc, colour = country)) + geom_line()+ labs(x = "", y = "GDP per capita (in 2011$)", caption = "Source: Maddison Project Database (MPD) 2023") + scale_x_continuous(breaks = dates)+ scale_y_continuous(limits = c(0,60000), breaks = c(0,10000,20000,30000,40000,50000,60000)) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5), legend.title=element_blank()) 
```

Figure \@ref(fig:mpdplot1) represents real GDP per capita over more than three centuries for fifteen of today's most important economies. Viewed through the lenses of GDP per capita, this data tells us a story of growing global wealth (or standards of living) and inequality:

- **Modern growth is a relatively recent phenomenon**: GDP per capita was relatively constant in all countries until the late 18th century. It then started increasing exponentially in all countries at some point over the last 200 years. In most countries this led to GDP per capita being multiplied by a factor of 10 or more. 
- **The great divergence**: This exponential growth pattern started at different times for different countries and there is nothing to suggest that the countries lagging behind will eventually catch up to the most advanced economies. In 1800, the United Kingdom was 4 to 5 times wealthier than Indonesia; whereas in 2019, the United States was 10 to 11 times wealthier than Nigeria. In other words, the difference between the richest and the poorest countries in this sample has grown from a factor of 4 to 5 in 1800 to a factor of 10 to 11 in 2018.
- **A variety of experiences**: Looking at the plot more closely, the path has not been entirely smooth in most countries, with some countries such as the Russian Federation, Japan or South Africa experiencing decades of stagnation or decline in the last 50 years. Some of the poorest countries (not represented here) have seen little to no growth as well as periods of prolonged decline over the same period (growth disasters).

This figure shows that the processes followed by GDP per capita are multiplicative rather than additive. We do not say "GDP per capita in the United Kingdom increased by \$34,010 between 1800 and 2018", but "GDP per capita is about 11 times larger in the United Kingdom in 2018 compared to what it was in 1800". Similarly, we do not say "GDP per capita in the United States is about \$50,097 higher than that of Nigeria in 2018", but "GDP per capita in the United States is about 10 times larger than that of Nigeria in 2018".

In this chapter, we will see how we can take into account these insights to calculate trend growth rates (using compound growth rates) and represent these growth experiences graphically (using logarithm plots). We will then use these techniques to extract some relevant facts about growth in countries across the world.

```{r Notes, eval=FALSE, include=FALSE}

A few notes of caution before we delve into this data in more detail: 

- We should not conclude from this first foray into long-run GDP growth trends that the processes underlying them are deterministic in the sense that they are produced by irrepressible forces largely beyond the control of human organisations or that they are normative in the sense that exponential growth represents the ultimate goal of human societies. Rather, the trends we observe reflect the outcomes of historical processes in different societies at different points in time. They are made possible by specific institutional, geographical, cultural characteristics and shaped by relationships of power within and between countries. 
- You might be tempted to see these numbers and the methods described in this chapter to analyse them as abstract, boring and even tedious. However, these facts convey important insights into the forces that shape the world today, from economics to geopolitics and cultural forces; ignoring them removes a critical point of view from which to understand a question or problem. 
- Many other tools are needed to be able to analyse these phenomena, some of them will be discussed in later chapters, but knowing how to produce and interpret growth rates and log plots should not be underestimated, just as it is important to understand how GDP data is constructed. It might impart to you some common sense and valuable communication skills. It will also help you understand better the theories developed in later chapters to explain these trends. 

```


## Per-period growth rate: definition and calculation

Most economic variables are observed at *discrete* time intervals. For example, to produce the plot in Figure \@ref(fig:mpdplot1), we used annual observations of GDP per capita (*see* Table \@ref(tab:DiscreteTab)). GDP is only observed at separate points in time. Time is discrete in the sense that it only takes on integer values, for example $t=2000, 2001, ..., 2004$. 

```{r DiscreteTab, echo=FALSE, warning=FALSE}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% select(country, year, gdppc) %>% 
  filter(country =="United States", year >= 2000 & year < 2023) %>% 
  mutate(gdpgr = (gdppc / lag(gdppc) - 1)*100) %>% 
  select(year, gdppc, gdpgr)

kbl(mpd2023, align = "ccc",col.names = c('Year (t)','GDP per capita (in $2011)', 'Growth rate (%)'), caption="US GDP per capita and growth rate (2000-2022)", digits = 2) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), position = "center") %>%
  kableExtra::footnote(general = "Source: Maddison Project Database 2023.", general_title = "")

```

The **per-period growth rate** of GDP in period $t$ is the *percentage change* in GDP between period $t-1$ and period $t$. Formally, the growth rate $g$ of variable $y$ in period $t$ (where the period may be a year, a quarter, a month, a day, ...) is calculated as: 
$$g_t = \frac{\Delta y_t}{y_{t-1}} = \frac{y_t-y_{t-1}}{y_{t-1}} = \frac{y_t}{y_{t-1}}-1$$
where $\Delta y_t=y_t-y_{t-1}$ is the *discrete time change* in variable $y$ between $t-1$ and $t$.

Expressed in percentage terms, this becomes:
$$\%g_t=\frac{y_t-y_{t-1}}{y_{t-1}} \times 100 $$
Using this formula and our annual GDP per capita data in Table \@ref(tab:DiscreteTab), we can calculate the *annual growth rate* of GDP per capita between two consecutive years. For example, the growth rate of GDP per capita in the United States in 2001 is given by: 
$$\% GDP_{2001}=\left(\frac{GDP_{2001}}{GDP_{2000}}-1\right) \times 100 = \left(\frac{45878}{45886}-1\right) \times 100 = -0.017\%$$

Note that a growth rate can be negative. In this case it simply means that the value of goods and services produced per person in the United States declined between 2000 and 2001. Column 3 of Table \@ref(tab:DiscreteTab) shows the annual growth rate of US GDP per capita in the following years. 

Add plot of annual growth rate and level of GDP per capita (with two scales).

## Trend growth rates and compounding

We have seen in the previous section how to calculate per-period growth rates or the growth rate between two consecutive periods, for example the growth rate of GDP from one year to the next. In this section, we turn our attention to the estimation of trend growth rates of GDP over one or several decades, ie the growth rates around which annual growth rates tend to fluctuate. A trend growth rate provides a clearer summary of long-run trends than a series of estimated annual growth rates as in Table \@ref(tab:DiscreteTab), as it abstracts from short-run annual fluctuations. It also provides a useful point of comparison for the growth rate of GDP in any particular year.

### The compound growth rate formula

How can we calculate the annual trend growth rate? Figure \@ref(fig:mpdplot3) represents actual GDP per capita in the United States between 1870 and 2018 (black solid line) and the trend in GDP per capita over the same period (dashed red line). We want to obtain an estimate of the annual growth rate of GDP per capita along this trend growth path. There are several methods to do so but there is at least one very incorrect one. 

```{r mpdplot3, echo=FALSE, fig.align='center', fig.cap= "GDP per capita in the United States: 1870-2023", warning=FALSE}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% select(country, year, gdppc) %>% filter(country == "United States", year >= 1870) %>% 
  mutate(gdpgr = (gdppc / lag(gdppc) - 1)*100)
dates <- seq(from = 1870, to = 2022, by = 20)

#average <- mean(mpd2023c$gdpgr, na.rm = TRUE)

mpd2023 %>% ggplot(aes(x = year, y = gdppc)) + geom_line(colour = "black", linewidth = 1) + stat_smooth(method=nls, method.args = list(start = c(a=4803, b=0.015)),formula = y ~ a*(1 + b)^(x-1870), colour = 'red', linewidth = 0.75, linetype = 2, se = FALSE) + labs(x = "", y = "GDP per capita (in 2011$)", caption = "Source: Maddison Project Database (MPD) 2023") + scale_x_continuous(breaks = dates)+ scale_y_continuous(limits = c(0,60000), breaks = c(0,10000,20000,30000,40000,50000,60000)) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5), legend.title=element_blank()) 

```

GDP per capita in the United States increased from \$4,803 in 1870 to \$55,335 in 2018. You might be tempted to calculate the trend annual growth rate over these 148 years by first calculating the growth rate of GDP per capita over the full period and dividing it by the number of years over that period as follows:
$$\bar{g} = \left(\frac{55,335}{4,803}-1 \right)\frac{1}{148}\times 100 = 7.11\%$$
However, that would be wrong. Starting at \$4,803 and assuming GDP per capita grows at an annual growth rate of 7.11% would lead to a level of GDP per capita in 2018 equal to \$124,840,484, more than 2000 times the actual value of GDP per capita in 2018! This cannot be a good estimate of the trend growth rate.

The **compound annual growth rate** provides an estimate of the trend growth rate which avoids falling into the same trap while also only requiring the first and last value of GDP per capita to be calculated. Intuitively, it is the constant growth rate such that if GDP per capita had grown at this same rate every year, then starting at the level of GDP per capita in 1870, GDP per capita 148 years later would be exactly equal to its actual value in 2018. 

To see how this works, let's do the following exercise. Assume that GDP per capita grows at the same rate $\bar{g}$ every year. Then using the definition of the growth rate from the previous section, the following must be true:
$$ \frac{GDP_{1871}}{GDP_{1870}}-1 = \bar{g} \quad  \rightarrow \quad =\frac{GDP_{1871}}{GDP_{1870}} = 1+\bar{g} $$

Rearranging, the value of GDP per capita in 1871 is equal to:
$$GDP_{1871}=(1+\bar{g})GDP_{1870}$$
and the value of GDP per capita in 1872 is equal to:
$$GDP_{1872}=(1+\bar{g})GDP_{1871}$$
In 1872, GDP per capita grows at rate $\bar{g}$ relative to its (base) value in 1871 and in 1871 it grows at rate $\bar{g}$ relative to its (base) value in 1870. Substituting the value of GDP per capita in 1871 into this expression gives:
$$GDP_{1872}=(1+\bar{g})(1+\bar{g})GDP_{1870}=(1+\bar{g})^{2}GDP_{1870}$$
Similarly, GDP per capita in 1873 can be expressed as:
$$GDP_{1873}=(1+\bar{g})(1+\bar{g})(1+\bar{g})GDP_{1870}=(1+\bar{g})^{3}GDP_{1870}$$

This result illustrates the *compounding* effect at work in such a growth process where the base value relative to which GDP per capita is calculated each year is continually updated at the end of the previous year. This effect explains how an economy that is growing at a relatively small annual rate of 1.5\% may nevertheless experience the exponential increase observed in Figures \@ref(fig:mpdplot1) and \@ref(fig:mpdplot3). The reason why the incorrect method discussed above overestimated the trend growth rate is because it ignores the presence of these compounding effects.

By repeated substitution, we obtain the following expression for GDP per capita in 2018 as a function of GDP per capita in 1870 and the constant growth rate $\bar{g}$:
$$GDP_{2018}=(1+\bar{g})^{148}GDP_{1870}$$
Solving for $\bar{g}$: 
$$\bar{g}=\left(\frac{GDP_{2018}}{GDP_{1870}} \right)^{\frac{1}{148}}-1 =\left(\frac{55,335}{4,803} \right)^{\frac{1}{148}}-1=0.01665 $$
or $\bar{g} = 1.67\%$. 

---------------------------------------------------------------------------------------------------

**Estimating the trend growth rate using the compound growth rate formula**

Assume we observe a trending variable $y$ (GDP, population, ...) which follows an exponential pattern between $t=0$ and $t$ and it grows at the trend growth rate $\bar{g}$ per period over this interval of time. After $t$ periods its value is equal to:
$$ y_t = (1+\bar{g})^{t} y_0 $$ 
We can recover $\bar{g}$ using the observed value of $y_0$ and $y_t$ and the *compound growth rate formula*:
$$ \bar{g} = \left(\frac{y_t}{y_0}\right)^{\frac{1}{t}} - 1 $$

----------------------------------------------------------------------------------------------------

*Note*: the compound annual growth rate is not the average growth rate.

### Is the compound annual growth rate a good measure of the trend growth rate?

It is easy to compute the trend growth rate over any given interval of time by just plugging in values into the compound growth rate formula. But the compound growth rate may be misleading or uninformative as a summary statistic of long-run trends when the trend growth rate fluctuates widely over time. There may be decades where the trend growth rate is small (and even negative), followed or preceded by decades where the trend growth rate is high. It is important to do a preliminary inspection of the data to check that you are fitting the appropriate model to your data. 

More generally, there is no reason to assume that the trend growth rate should be constant over time. Techniques have been developed to estimate variable trend growth rates. These are more computationally intensive and exploit more information. This is particularly important if we are interested in estimating the short-run deviations of GDP from its trend. For the purpose of evaluating long-run growth trends, we are mainly interested in broad changes in the magnitude of the trend growth rate and it will be useful to complement the analysis by calculating trend growth rates over carefully selected subperiods. We will see how this can be done using logarithm plots in the next section.


## Logarithm plots and ratio scales

Plots of GDP on a logarithmic or ratio scale feature frequently in the economic press. A few examples can be found [here](https://www.ft.com/content/e577411e-3bf2-4fb4-872a-8b7d5e9139d3) and [here](https://www.theguardian.com/uk-news/2024/mar/02/conservatives-economic-record-budget-deficit-gdp-tax-tory-budget). In this section, we explain why these plots are useful representations of GDP trends and how to interpret them.

### Growth rates and logarithms

A good approximation to the per-period growth rate can be derived from the properties of logarithms. 

The per-period growth rate $g_t$ of variable $y$ is the growth rate in period $t$ such that $y_t = (1+g_t) y_{t-1}$. By taking the natural  logarithm on both sides of this expression and subtracting $\ln{y_{t-1}}$, we obtain:
$$\ln{y_t} - \ln{y_{t-1}} = \ln{(1+g_t)}$$
from which we derive the following approximation for $g_t$: 
$$\Delta\ln{y_t}\approx g_t$$
where $\Delta\ln{y_t}$ is the change in the natural logarithm of $y$ in period $t$ and the approximation $\ln{(1+g_t)} \approx g_t$ holds for small values of $g_t$. The equality would hold exactly if $y$ were a continuous variable (*see* Appendix). What this result tells us is that the per-period growth rate of variable $y$ in any period can be approximated by the change in the natural logarithm of $y$.

### Representing growth rates using logarithm plots

This result suggests that growth rates can be read off the plot of the (natural) logarithm of variable $y$ against time, where the slope at any point in time is the change in the logarithm of $y$ ($\Delta\ln{y_t}$), and approximately equal to its growth rate.  

The left panel of Figure \@ref(fig:logplot1) plots a variable $y$ which grows over time at a compounded constant growth rate $g$ according to the following function: $y_t = (1+g)^t y_0$. We set $y_0=1$ and $g=0.05$, so $y$ grows at the rate of 5% in each period starting at an initial value of 1. 

```{r logplot1, fig.cap= "Plots of a variable growing at a constant rate", fig.width=8, fig.height=3, echo=FALSE}

rm(list=ls())
z <- as_tibble(seq(1:103)) %>% mutate(y = (1+0.05)^{value}, lny = log(y))
plot1 <- ggplot(z, aes(x = value, y = y)) + geom_line() + labs(x = "t", y = "") + scale_x_continuous(breaks = waiver(), n.breaks = 10)+ scale_y_continuous(limits = c(0,160), breaks = c(0,50,100,150)) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line()) + labs(title = "Plot of y")
plot2 <- ggplot(z, aes(x = value, y = lny)) + geom_line() + labs(x = "t", y = "lny") + theme_bw() + theme_minimal() +scale_x_continuous(breaks = waiver(), n.breaks = 10)+ scale_y_continuous(limits = c(0,5.05), breaks = c(0,1,2,3,4,5))  + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),panel.grid.major.x = element_line()) + labs(title = "Plot of (natural) logarithm of y")
plot1 + plot2

```

The right panel of Figure \@ref(fig:logplot1) plots the natural logarithm of $y$ allowing us to see immediately that $y$ grows at a constant rate (the straight line has constant slope). This follows from the fact that the logarithm of $y$ is a linear function of time:
$$y_t = (1+g)^t y_0 \quad \rightarrow \quad \ln{y_t}=\ln{(1+g)}\times t+\ln{y_0} \approx g\times t+\ln{y_0}$$
It is easy to verify that the slope of the logarithm plot ($\Delta\ln{y}/\Delta t$) is equal to 0.05, the growth rate of $y$.


```{r logplot1b, eval=TRUE, fig.cap= "Plots of three variables growing at a constant rate", fig.width=8, fig.height=3, echo=FALSE}

rm(list=ls())
z <- as_tibble(seq(1:100)) %>% mutate(y1 = (1+0.01)^{value},y2 = (1+0.02)^{value},y3 = (1+0.03)^{value})
z <- pivot_longer(z,!value,names_to = "g",names_prefix = "y",values_to = "y") %>% mutate(lny = log(y))
plot1 <- ggplot(z, aes(x = value, y = y ,colour = g)) + geom_line() + labs(x = "t", y = "") + scale_x_continuous(breaks = waiver(), n.breaks = 5)+ scale_y_continuous(limits = c(0,20), breaks = c(0,5,10,15,20))+ theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_blank()) + labs(title = "Plot of y") + scale_colour_discrete(name = "",breaks = c("1", "2", "3"),labels = c("g = 0.01", "g = 0.02", "g = 0.03"), guide = guide_legend(reverse=TRUE))
plot2 <- ggplot(z, aes(x = value, y = lny ,colour = g)) + geom_line() + labs(x = "t", y = "lny") + theme_bw() + theme_minimal() +scale_x_continuous(breaks = waiver(), n.breaks = 5)+ scale_y_continuous(limits = c(0,3), breaks = c(0,1,2,3))  + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_blank(),panel.grid.major.x = element_blank()) + labs(title = "Plot of (natural) logarithm of y")+ scale_colour_discrete(name = "",breaks = c("1", "2", "3"),labels = c("g = 0.01", "g = 0.02", "g = 0.03"),guide = guide_legend(reverse=TRUE))
plot1 + plot2
```

Figure \@ref(fig:logplot1b) plots $y$ and its logarithm for three different value of the constant growth rate $g$. The exponential gap in the path of the three series illustrates the compounding effect of growth. A small difference in growth rates can generate large inequalities in the long-run.


**Example: GDP per capita in the United States (1870-2023)**

Going back to US real GDP per capita, we already noticed the exponential pattern of GDP per capita over the last two centuries. Focusing on the period 1870-2018, we can now check graphically whether the US economy grew at a relatively constant rate over this period. If the growth rate is constant over time we would expect the plot of its logarithm to be well approximated by a straight line.

```{r mpdplot4, echo=FALSE, fig.align='center', fig.cap= "(Level and logarithm of) GDP per capita in the United States: 1870-2023", warning=FALSE, message=FALSE, fig.width=10, fig.height=3}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% 
  filter(country == "United States", year >= 1870) %>% 
  mutate(lny = log(gdppc)) %>% 
  select(year, gdppc, lny) %>% 
  rename(t = "year") 
dates <- seq(from = 1880, to = 2023, by = 40)

plot1 <- mpd2023 %>% ggplot(aes(x = t, y = gdppc)) + geom_line(colour = "red")+ labs(x = "", y = "GDP per capita (in 2011$)") + scale_x_continuous(breaks = dates) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5))

plot2 <- mpd2023 %>% ggplot(aes(x = t, y = lny)) + geom_line(colour = "red") + labs(x = "", y = "(ln) GDP per capita") + scale_x_continuous(breaks = dates) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5))

plot3 <- mpd2023 %>% ggplot(aes(x = t, y = lny)) + geom_line(colour = "red") + geom_smooth(method=lm,se=FALSE) + labs(x = "", y = "(ln) GDP per capita", caption = "Source: Maddison Project Database (MPD) 2023") + scale_x_continuous(breaks = dates) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5))

plot1 + plot2 + plot3

```

The middle panel in Figure \@ref(fig:mpdplot4) represents the natural logarithm of US real GDP per capita. Although not perfect, the plot does appear to be approximately linear, suggesting a relatively constant growth rate over the long-run. This hypothesis can be further evaluated by fitting a line of best fit (in blue) to the plot of the logarithm (right panel) and checking how well the line fits the data. The estimate of the slope of the line of best fit is 0.0167, which corresponds to a growth rate of 1.67% per year and is similar to the compound growth rate calculated in the previous section.

```{r draft, eval=FALSE, include=FALSE}

lmtrend <- lm(lny ~ t,mpd2023)
lmtrend
```

### Logarithmic (ratio) scales

We have seen how the slope of the plot of the logarithm of the trending variable $y$ allows us to evaluate quickly what happens to the growth rate of $y$ over time. We now turn to what it means to plot the logarithm of a variable, ie to represent a variable on a logarithmic (or ratio) scale. 


The left and middle panels of Figure \@ref(fig:logplot2) represent the same variable $y$ growing at a rate of 5% per period and its natural logarithm $\ln{y}$ once again. The natural logarithm of $y$, is the number of times Euler's number $e=2.72...$ needs to be multiplied by itself in order to obtain $y$. The plots shows that when $y$ is equal to 150, its natural logarithm is approximately equal to 5. So 5 is the natural logarithm of 150, or the number of times $e$ needs to be multiplied by itself to obtain the number 150 (to be more exact, 5 is the natural logarithm of $e^5=148.4132$). 

```{r logplot2, fig.cap= "Representing variables on a logarithmic scale", fig.width=8, fig.height=3, echo=FALSE}

rm(list=ls())
z <- as_tibble(seq(1:103)) %>% mutate(y = (1+0.05)^{value}, lny = log(y))
plot1 <- ggplot(z, aes(x = value, y = y)) + geom_line() + labs(x = "time", y = "y") + scale_x_continuous(breaks = waiver(), n.breaks = 6)+ scale_y_continuous(limits = c(0,160), breaks = c(0,50,100,150)) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line()) + labs(title = "y")
plot2 <- ggplot(z, aes(x = value, y = lny)) + geom_line() + labs(x = "time", y = "lny") + theme_bw() + theme_minimal() +scale_x_continuous(breaks = waiver(), n.breaks = 6)+ scale_y_continuous(limits = c(0,5.05), breaks = c(0,1,2,3,4,5))  + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),panel.grid.major.x = element_line()) + labs(title = "(natural) logarithm of y")
plot3 <- ggplot(z, aes(x = value, y = lny)) + geom_line() + labs(x = "time", y = "y") + theme_bw() + theme_minimal() +scale_x_continuous(breaks = waiver(), n.breaks = 6)+ scale_y_continuous(limits = c(0,5.05), breaks = c(0,1,2,3,4,5), label = c(0,2.7,7.4,20.1,54.6,148.4))  + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),panel.grid.major.x = element_line()) + labs(title = "y (log scale)")
plot1 + plot2 + plot3

```

This gives us an alternative interpretation of the logarithm plot: every tick mark on the vertical axis, y is multiplied by $e$. So when at time $t=40$ we read off the plot that $lny=2$, this means that $y$ is approximately equal to $e^2=7.389$. Similarly, $lny=3$ at time $t=60$ means that $y$ is approximately equal to $e^3=20.086$. This is the intuition behind the **logarithmic scale** (also called *log scale* or *ratio scale*) represented on the right panel, which is constructed by relabeling the value of the natural logarithm of $lny$ on the vertical axis with the corresponding value of $y$.

Changing the base number of the logarithm allows us to set more intuitive multiplying factors. For example, the logarithm base 2 of $y$, represents the number of times the number 2 needs to be multiplied by itself to obtain $y$. So on a plot of the logarithm base 2 of $y$ (right panel of Figure \@ref(fig:logplot3)), every tick mark on the vertical axis, y is multiplied by 2. It can be used to read graphically on the horizontal axis how long it takes for variable $y$ to double. 

```{r logplot3, fig.cap= "Representing variables on a logarithmic scale (base 2)", fig.width=8, fig.height=3, echo=FALSE}

rm(list=ls())
z <- as_tibble(seq(1:103)) %>% mutate(y = (1+0.05)^{value}, lny = log2(y))

plot1 <- ggplot(z, aes(x = value, y = y)) + geom_line() + labs(x = "time", y = "y") + scale_x_continuous(breaks = waiver(), n.breaks = 6)+ scale_y_continuous(limits = c(0,160), breaks = c(0,50,100,150)) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line()) + labs(title = "y")
plot2 <- ggplot(z, aes(x = value, y = lny)) + geom_line() + labs(x = "time", y = "y") + theme_bw() + theme_minimal() +scale_x_continuous(limits = c(0,105), breaks = c(0,15,30,45,60,75,90,105))+ scale_y_continuous(limits = c(0,8), breaks = c(0,1,2,3,4,5,6,7,8), label = c(0,2,4,8,16,32,64,128,256))  + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),panel.grid.major.x = element_line()) + labs(title = "y (log scale base 2)")
plot1 + plot2 

```

We can see that it takes slightly less than fifteen periods for $y$, which is growing at the rate of 5% per period, to double. So fifteen years is the number of years it takes for the GDP per capita of an economy that is growing at the rate of 5% per year to double. This may seem surprising but is a direct consequence of the compounding effects discussed before. 

*Note*: if the variable grows at a constant rate, the slope of the plot of of the logarithm base 2 is constant, but it is not equal to the growth (although it is proportional to it).

### Rule of 70 {-}

Assuming a variable $y$ grows at a constant annual growth rate $g$, how many years $t$ does it take for it to double in value? We just saw how plotting a variable using a log scale allows us to see immediately how long it would take for a variable to double (or triple, quadruple, etc...). It is also possible to address this question numerically. A useful result called the *rule of 70* states that if a variable $y$ grows at the rate of $\%g$ per period, then it takes approximately $t \approx \frac{70}{\%g}$ periods for the value of $y$ to double. So when $y$ grows at rate $g=0.05$ in each period as in our example, the formula predicts that it would take approximately 14 periods for it to double, in line with what we observed in Figure \@ref(fig:logplot3). 

**Example: GDP per capita in the United States (1870-2022)**

```{r mpdplot5, echo=FALSE, fig.align='center', fig.cap= "GDP per capita in the United States (in 2011$): normal and logarithmic scale", warning=FALSE, message=FALSE, fig.width=8, fig.height=3}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% 
  filter(country == "United States", year >= 1870) %>%
  rename(t = "year") %>%
  select(t, gdppc) 
 
dates <- seq(from = 1870, to = 2023, by = 35)

plot1 <- mpd2023 %>% ggplot(aes(x = t, y = gdppc)) + geom_line(colour = "red")+ labs(x = "", y = "Normal scale") + scale_x_continuous(breaks = dates) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5)) + scale_y_continuous(limits = c(0,64000), breaks = c(0,16000,32000,48000,64000))
plot2 <- mpd2023 %>% ggplot(aes(x = t, y = gdppc)) + geom_line(colour = "red") + labs(x = "", y = "Log scale (base 2)", caption = "Source: Maddison Project Database (MPD) 2023") + scale_x_continuous(breaks = dates) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_line(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5)) + scale_y_continuous(trans='log2',limits = c(4000,64000), breaks = c(4000,8000,16000,32000,64000))
plot1 + plot2

```

Figure \@ref(fig:mpdplot5) illustrates how this tool can be used to analyse the behaviour of GDP per capita over time. The right panel shows that it took slightly more than 35 years for GDP per capita to double in the United States, consistent with the prediction of the rule of 70 that when GDP per capita is growing at the trend rate of 1.67%, it will take about 42 years to double.

## United Kingdom *versus* United States

```{r mpdplot2, echo=FALSE, fig.align='center', fig.cap= "GDP per capita in the United States and United Kingdom: 1800-2022", warning=FALSE,fig.width=8, fig.height=4}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2020.csv",show_col_types = FALSE) %>% select(country, year, gdppc) %>% filter(country == "United Kingdom" | country == "United States", year >= 1800) 
dates <- seq(from = 1800, to = 2023, by = 100)

mpd2023 %>% ggplot(aes(x = year, y = gdppc, colour = country)) + geom_line()+ labs(x = "", y = "GDP per capita (in 2011$)", caption = "Source: Maddison Project Database (MPD) 2023") + scale_x_continuous(breaks = dates)+ scale_y_continuous(limits = c(0,60000), breaks = c(0,10000,20000,30000,40000,50000,60000)) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5), legend.title=element_blank()) 

```

Figure \@ref(fig:mpdplot2) shows that on average GDP per capita in the United States grew faster than in the United Kingdom over the last 200 years since it starts at a lower level and ends at a higher level. However, some questions are less easily answered just by looking at this plot. **First**, was the *growth rate* of GDP per capita in the United States and the United Kingdom constant over time or were there periods of faster (slower) growth? **Second**, was GDP per capita in the United States always growing at a faster rate than in the United Kingdom over these two centuries or only during specific periods?

We can address these questions using the techniques developed in the previous sections. Figure \@ref(fig:mpdplot6) plots the logarithm of GDP per capita for both countries and can be used to identify subperiods. Table \@ref(tab:mpd2023Tab) presents estimates of the trend growth rates of GDP per capita for both the United States and the United Kingdom for the full sample period and four subperiods.


```{r mpdplot6, echo=FALSE, fig.align='center',fig.cap= "United States vs United Kingdom: GDP per capita (1800-2022)",fig.width=6, fig.height=3.5, eval=TRUE, message=TRUE}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% 
  select(country, year, gdppc) %>% 
  filter(country == "United Kingdom" | country == "United States", year >= 1800) %>% 
  mutate(lny = log(gdppc))%>% 
  select(country, year, lny) %>% 
  pivot_wider(names_from = country, values_from = lny) 

dygraph(mpd2023)  %>%
  dySeries("United Kingdom", label = "UK") %>%
  dySeries("United States", label = "US") %>%
  dyLegend(show = "follow", width =350 )%>%
  dyAxis("x", drawGrid = FALSE) %>%
  dyAxis("y", label = "Ln (GDP per capita)") %>%
  dyOptions(includeZero = FALSE, 
            axisLineColor = "black", 
            drawGrid = FALSE,
            colors = c("#FA8072","#00CED1"))

```

<br>
**Did the two economies grow at a constant rate over the last two centuries or were there periods of faster or slower growth?**

In the <span style="color: #FA8072;">**United Kingdom**</span>, we identify two important points of inflection in the slope of the logarithm plot, in 1830 and 1920, allowing us to distinguish three subperiods. In <span style="color: #FA8072;">1800-1830</span>, the slope of the log plot is relatively flat, suggesting that the trend growth rate was close to zero before 1830. In <span style="color: #FA8072;">1830-1918</span>, the slope of the log plot becomes steeper, suggesting that the trend growth rate established itself clearly in the positive range during this period. In <span style="color: #FA8072;">1920-2022</span>, the slope of the log plot rises again, suggesting that the trend growth rate further rose in the 20^th^ century. 

In the <span style="color: #00CED1;">**United States**</span>, the path of GDP per capita exhibits a similar pattern, but with an point of inflection occurring in the 1940s. In <span style="color: #00CED1;">1800-1830</span>, the slope of the log plot is flatter, suggesting that the trend growth rate is positive but moderate before 1830. In <span style="color: #00CED1;">1830-1946</span>, the slope of the log plot becomes steeper, suggesting that the trend growth accelerated during this period. In <span style="color: #00CED1;">1946-2022</span>, the slope of the log plot becomes only slightly steeper, suggesting a relatively constant trend growth rate in the United States over the 20^th^ century as previously noted. 

**Can we identify periods when GDP per capita in the United States grew at a substantially faster rate than that of the United Kingdom?**

Over the period *1946-2022*, the trends in GDP per capita are parallel in the two countries, suggesting that GDP per capita grew at relatively similar rates. However, between *1800* and *1946*, GDP per capita grew at a substantially higher trend growth rate in the United States, which is the period when US GDP per capita overtook UK GDP per capita. 

```{r mpd2023Tab, echo=FALSE, warning=FALSE, eval=TRUE, message=TRUE}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% 
  select(country, year, gdppc) %>% 
  filter(country == "United Kingdom" | country == "United States", year >= 1800) %>% 
  pivot_wider(names_from = country, values_from = gdppc) %>% 
  rename(US = "United States", UK = "United Kingdom")
  
break_dates <- c(1800,1830,1946,2022)
break_nb <- length(break_dates)
date_nb <- length(mpd2023$year)
gy_US <- ((mpd2023$US[date_nb]/mpd2023$US[1])^(1/(break_dates[break_nb]-break_dates[1]))-1)*100
gy_UK <- ((mpd2023$UK[date_nb]/mpd2023$UK[1])^(1/(break_dates[break_nb]-break_dates[1]))-1)*100
table <- as_tibble_row(c("US" = gy_US, "UK" = gy_UK))
index <- c()
for (date in break_dates){
  row_nb <- which(grepl(date,mpd2023$year))
  index <- c(index,row_nb)
}
for (i in seq(1:(break_nb-1))){
  gy_US <- ((mpd2023$US[index[i+1]]/mpd2023$US[index[i]])^(1/(break_dates[i+1]-break_dates[i]))-1)*100
  gy_UK <- ((mpd2023$UK[index[i+1]]/mpd2023$UK[index[i]])^(1/(break_dates[i+1]-break_dates[i]))-1)*100
  table <- add_row(table,US = gy_US, UK = gy_UK)
}
subperiods <- as_tibble_col(c("1800-2022","1800-1830","1830-1946","1946-2022"))
table <- add_column(subperiods,table)

kbl(table, align = "ccc",col.names = c("Period","United states", "United Kingdom"), caption="UK and US: Trend growth rates over different subperiods", digits = 2) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), position = "center") %>%
  kableExtra::footnote(general = "Source: Maddison Project Database 2023. Compound annual growth rates (%).", general_title = "")

```

The figures in Table \@ref(tab:mpd2023Tab) confirm the key points observed above, including the fairly constant trend growth rate of US GDP per capita since the 1830s and the increase in the growth of GDP per capita in both countries in the second half of the 20^th^ century. This also allows us to make an additional remark. The estimated trend growth rate of GDP per capita in the United States is 0.4 percentage point higher than that of the United Kingdom between 1830 and 1946. This relatively small difference on an annual basis explains why by the end of this period, US GDP per capita was almost 50% higher than that of the UK, having started at a lower level (*See* Figure \@ref(fig:mpdplot2)).

**Remark**: we only emphasise here the interpretation of the figures and the broad trends emerging from the data. *First*, it is difficult to establish what happened to the trend growth rates during the interwar period (from 1919 to 1939). *Second*, different measures of real GDP may give widely different results for the date at which US GDP per capita overtook UK GDP per capita and also possibly the estimates of trend growth rates. *Third*, the trend growth rate has clearly declined over the last fifteen years in both countries; however, it may be too early to draw conclusion regarding the significance of this recent development.


```{r mpdplot7a, echo=FALSE, fig.align='center',fig.cap= "United States vs United Kingdom: relative GDP per capita (1800-2018)",fig.width=8, fig.height=4, eval=FALSE, message=TRUE}

rm(list=ls())
mpd2020 <- read_csv("Data/mpd2020.csv",show_col_types = FALSE) %>% 
  select(country, year, gdppc) %>% 
  filter(country == "United Kingdom" | country == "United States", year >= 1800) %>% 
  pivot_wider(names_from = country, values_from = gdppc) %>% 
  rename(US = "United States", UK = "United Kingdom") %>% 
  mutate("United States" = US/UK, "United Kingdom" = UK/UK) %>% 
  select(year,"United States","United Kingdom") %>% 
  pivot_longer(cols = c("United States","United Kingdom"), names_to = "country", values_to = "ratio")

dates <- seq(from = 1800, to = 2018, by = 30)
  
mpd2020 %>% ggplot(aes(x = year, y = ratio, colour = country)) + geom_line()+ labs(x = "", y = "", caption = "Note: the series represented is the ratio of US GDP and UK GDP. \n Source: Maddison Project Database (MPD), 2020") + scale_x_continuous(breaks = dates) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5), legend.title=element_blank()) + labs(title = "GDP per capita relative to UK (UK=1)")+ scale_colour_discrete(labels=c("United Kingdom", "United States"))

#This can also be observed in Figure \@ref(fig:mpdplot7), which plots the ratio of GDP per capita in the United States and in the United Kingdom (so it is equal to 1 when US and UK GDP per capita are equal). Until the 1870s, US GDP per capita was about 15% lower than that of UK GDP per capita; by the 1950s, it was 40% higher than UK GDP per capita. 

```



```{r mpdplot7b, echo=FALSE, fig.align='center', fig.cap= "GDP per capita relative to the US: 1870-2018", warning=FALSE, eval=FALSE}

## Convergence facts

PWT: scatter plots growth of GDP per capita versus GDP per capita in 1970 (1990):

- all countries 
- subset countries

Plot of convergence towards US GDP per capita

rm(list=ls())

mpd2020 <- read_csv("Data/mpd2020.csv",show_col_types = FALSE) %>% 
  select(country, year, gdppc) %>% 
  filter(year >= 1950) %>% 
  pivot_wider(names_from = country, values_from = gdppc) %>%
  arrange(year) %>%
  rename(US = "United States") %>%
  mutate(across(2:170, ~.x/US)) %>% 
  pivot_longer(!year, names_to = "country", values_to = "gdppc_ratio") %>% 
  arrange(country,year) 

dates <- seq(from = 1950, to = 2018, by = 10)

mpd2020 %>% ggplot(aes(x = year, y = gdppc_ratio, colour = country)) + geom_line(show.legend = FALSE)+ labs(x = "", y = "", caption = "Note: the series represented are the ratios of each country's GDP and US GDP. \n Source: Maddison Project Database (MPD), 2020") + scale_x_continuous(breaks = dates) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5), legend.title=element_blank()) + labs(title = "GDP per capita relative to US (US=1)")

#mpd2020 <- mpd2020 %>% filter(gdppc_ratio>1.8)

#mpd2020 <- mpd2020 %>% filter(country != "Kuwait" & country != "Qatar" & country != "United Arab Emirates")

```

```{r mpdplot7c, echo=FALSE, fig.align='center', fig.cap= "GDP per capita relative to the US: 1870-2018", warning=FALSE,eval=FALSE}

rm(list=ls())

mpd2020 <- read_csv("Data/mpd2020.csv",show_col_types = FALSE) %>% 
  select(country, year, gdppc) %>% 
  filter(year >= 1950) %>% 
  pivot_wider(names_from = country, values_from = gdppc) %>%
  arrange(year) %>%
  rename(US = "United States") %>%
  mutate(across(2:170, ~.x/US)) 

dygraph(mpd2020) %>% dyLegend(show = "follow")

```

```{r draft_sections, eval=FALSE, include=FALSE}

## GDP growth around the world

How was the data constructed and by who? How reliable is the data? How much does it rely on estimation / imputation?

Create graphs encompassing all countries in the dataset by continent (Europe, America, Africa, Middle East, Central Asia, Asia, Australasia) showing:

- Series relative to US (or other country?)
- Scatter initial GDP per capita vs GDP growth over the last 30 years
- Plot of GDP per capita for selected countries (one per geographical area?)

Possible countries: Ethiopia, Singapore and Hong Kong, Russian Federation and Ukraine, Haiti and Dominican Republique, Palestine, Ecuador

## Population growth and GDP per capita growth

Maddison / PWT data:

- Plot and bars chart of GDP growth, GDP per capita growth and population growth in UK, US over the subperiods used in previous section.
- Bar chart of GDP growth, GDP per capita growth and population growth for a selection of other countries (China, India, Senegal, Chile, Mexico, Phillipines or Thailand, Madagascar)

The complex relationship between population growth and GDP per capita growth:

- Malthus
- M. Kremer
- [UN Chronicle](https://www.un.org/en/un-chronicle/world-population-surpasses-8-billion-what-are-implications-planetary-health-and)
- [IMF F\&D](https://www.imf.org/en/Publications/fandd/issues/Series/Analytical-Series/aging-is-the-real-population-bomb-bloom-zucker)

Data sources: 

- [United Nations](https://population.un.org/wpp/)
- [ourworldindata.org](https://ourworldindata.org/population-growth#introduction)
- [ONS](https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationprojections)


```


## Summary {-}

In this chapter, we have seen that:

- The per-period growth rate is calculated as: $$\%g_t=\frac{y_t-y_{t-1}}{y_{t-1}} \times 100 $$
- The compound growth rate provides a useful measure of the trend growth when we want to analyse long-run growth trends of series that follow an exponential growth pattern. It is calculated as:
$$ \bar{g} = \left(\frac{y_t}{y_0}\right)^{\frac{1}{t}} - 1 $$
where $\bar{g}$ is the trend growth rate and $y_0$ is the initial value of $y$.
- We have learnt how to "see" growth rate trends using logarithm plots. The slope of the plot of the logarithm of a series over time provides a good approximation of the growth rate of this series at any point in time, provided the growth rate is small enough.
- A log plot represents how many times a variable is multiplied by a given factor over a certain interval of time. It is particularly well suited to 
- Describing and comparing trends in GDP growth across the world and over time

1. Growth of GDP per capita is a relatively recent phenomenon.
1. GDP per capita has grown at a relatively constant rate in the US (about 1.67\% per year) and the UK between 1870 and 2019. 



## Exercises {-}

**Exercise 1**

The annual growth rate of real GDP per worker in the UK was 0.18% in 2019 (*Source*: PWT). What is this growth rate in fractional term?
 
 a. 0.18
 a. 0.018
 a. 0.0018
 a. 18
 
 **Exercise 2**         
 
The growth rate of GDP per capita in 2019 in Haiti was -0.02165 (*Source*: PWT). What is the growth rate of GDP per capita?
 
 a. -0.02165%
 a. -0.22%
 a. -2.2%
 a. 0%

**Exercise 3**

| Year | GDP per worker (in 2017$)|
|:----:|:------------------------:|
|2018  | 24823.13                 |
|2019  | 25754.14                 |

The table above presents GDP per worker in China (*Source*: PWT). What is the growth rate of GDP per Worker in China in 2019?
 
 a. 0.04%
 a. 1.04%
 a. 3.75%
 a. 1.04
 
**Exercise 4**

```{r mpdplot8a, echo=FALSE, fig.align='center',fig.width=6, fig.height=4, warning=FALSE, message=FALSE}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% 
  filter(country == "Indonesia", year >= 1950) %>%
  select(year, gdppc) %>% 
  rename(t = "year") 
#dates <- seq(from = 1950, to = 2023, by = 10)

dygraph(mpd2023, main = "GDP per capita in Indonesia: 1950-2022") %>% 
  dySeries("gdppc", label = "GDP per capita") %>%
  dyLegend(show = "follow")%>%
  dyAxis("x", drawGrid = FALSE) %>%
  dyAxis("y", label = "GDP per capita (in 2011$)") %>%
  dyOptions(includeZero = FALSE, 
            axisLineColor = "navy", 
            gridLineColor = "lightblue")

```
 
<br>
Based on the plot above (*Source*: Maddison Project Database 2023) the annual trend growth rate in GDP per capita in Indonesia between 1950 and 2018 was:
 
 a. 12%
 a. 3.32%
 a. 3.27%
 a. 8.26%

**Exercise 5**

```{r mpdplot8b, echo=FALSE, fig.align='center',fig.width=6, fig.height=4, warning=FALSE, message=FALSE}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% 
  filter(country == "Indonesia", year >= 1950) %>% 
  mutate(lny = log(gdppc)) %>% 
  select(year, lny) %>% 
  rename(t = "year") 

dygraph(mpd2023, main = "(Logarithm) GDP per capita in Indonesia: 1950-2022") %>% 
  dySeries("lny", label = " Log(GDP per capita)") %>%
  dyLegend(show = "follow")%>%
  dyAxis("x", drawGrid = FALSE) %>%
  dyAxis("y", label = "Log (GDP per capita)") %>%
  dyOptions(includeZero = FALSE, 
            axisLineColor = "navy", 
            gridLineColor = "lightblue")

```

<br>
The figure above represents the logarithm of GDP per capita in Indonesia (*Source*: Maddison Project Database 2023). Discuss the advantages and disadvantages associated with each of these subsamplings i) if the goal were to analyse long-run growth trends in GDP growth in Indonesia and ii) if you goal were to systematically compare GDP growth in different countries over time:

a. 1950-1970, 1970-1990, 1990-2010, 2010-2022
a. 1950-1967, 1967-1997, 1997-2022
a. 1950-1967, 1967-1974, 1974-1989, 1989-1997, 1990-2022
a. 1950-1967, 1967-2022


**Exercise 6**

```{r mpdplot8c, echo=FALSE, fig.align='center', fig.cap= "GDP per capita in Indonesia (ratio scale): 1950-2022",fig.width=6, fig.height=4, warning=FALSE, message=FALSE}

rm(list=ls())
mpd2023 <- read_csv("Data/mpd2023.csv",show_col_types = FALSE) %>% 
  filter(country == "Indonesia", year >= 1950) %>% 
  select(year, gdppc) %>% 
  rename(t = "year") 

dates <- seq(from = 1950, to = 2022, by = 10)

plot3 <- mpd2023 %>% ggplot(aes(x = t, y = gdppc)) + geom_line(colour = "blue")+ labs(x = "", y = "GDP per capita (in 2011$)")+ scale_x_continuous(breaks = dates) + scale_y_continuous(trans = 'log2', limits = c(1000,16000), breaks = c(1000,2000,4000,8000,16000)) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5))

plot3

```

The figure above represents GDP per capita in Indonesia on a ratio scale (*Source*: Maddison Project Database 2023). 

a. Based on this figure, how many years did it take approximately for GDP per capita to double in Indonesia over this period?
b. Using your answer in a., provide an approximation for the trend growth rate. 

**Exercise 7**

(harder) Assume that variable $y$ grows ar rate $g\%$ every year and is compounded at the end of each year. Show that $t \approx \frac{70}{g\%}$. 
  *Hint*: use the following approximation $\ln{(1+g)} \approx g$ (for small values of g).


```{r ex-draft, eval=FALSE, echo=FALSE}

**Exercise 8**

#```{r mpdplot9, echo=FALSE, fig.align='center', fig.cap= "(Logarithm) GDP per capita in Russia: 1960-2018",fig.width=6, fig.height=4, warning=FALSE, message=FALSE}

rm(list=ls())
mpd2020 <- read_csv("Data/mpd2020.csv",show_col_types = FALSE) %>% 
  filter(country == "Russian Federation", year >= 1960) %>% 
  mutate(lny = log(gdppc)) %>% 
  select(year, gdppc, lny) %>% 
  rename(t = "year") 
dates <- seq(from = 1960, to = 2018, by = 10)

plot2 <- mpd2020 %>% ggplot(aes(x = t, y = lny)) + geom_line(colour = "orange")+ labs(x = "", y = "GDP per capita (in 2011$)")+ scale_y_continuous(limits = c(8.5,10.5), breaks = c(8.5,9,9.5,10,10.5))+ scale_x_continuous(breaks = dates) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5))

plot2

#```

#```{r mpdplot10, echo=FALSE, fig.align='center', fig.cap= "GDP per capita in Haiti: 1945-2018",fig.width=6, fig.height=4, warning=FALSE, message=FALSE}

rm(list=ls())
mpd2020 <- read_csv("Data/mpd2020.csv",show_col_types = FALSE) %>% 
  filter(country == "Haiti", year >= 1945) %>% 
  mutate(lny = log(gdppc)) %>% 
  select(year, gdppc, lny) %>% 
  rename(t = "year") 
dates <- seq(from = 1945, to = 2018, by = 10)

plot1 <- mpd2020 %>% ggplot(aes(x = t, y = gdppc)) + geom_line(colour = "red")+ labs(x = "", y = "GDP per capita (in 2011$)")+ scale_x_continuous(breaks = dates) + theme_bw() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.grid.major.y = element_line(),plot.title = element_text(hjust = 0.5))
 
plot1

#```
  
Figure \@ref(fig:mpdplot9) represents the logarithm of GDP per capita in the Russian federation and Figure \@ref(fig:mpdplot10) represents the level of GDP per capita in Haiti (*Source*: Maddison Project Database).

Discuss the best strategy to estimate the trend growth rate in both cases.

**Exercise 9**

Table with GDP level and trend growth rate of GDP since the 2007-2008 financial crisis in the UK, France, Germany and Italy. Discuss the economic significance of the low trend rates of GDP growth in the UK over the last decade in the long-run.
```


## Practice questions in Excel {-}

In order to perform these practice questions, you need to work on a laptop or a desktop computer (if possible using a mouse), **not** a tablet. You also need to have installed Excel on your device (you may not be able to perform all the operations using the web version).

Before attempting the questions below, go through the Excel tutorial (include link) which shows how to perform basic operations using the *Penn World Table* dataset in Excel and make sure you are able to replicate the results.

**Question 1**

To address this question, you may find it useful to check *Table 1* (p3154) *in* Feenstra, Robert C., Robert Inklaar and Marcel P. Timmer (2015), "The Next Generation of the Penn World Table", *American Economic Review*, 105(10), 3150-3182, which can be accessed at <a href="https://www.rug.nl/ggdc/productivity/pwt/related-research" target="_blank">*www.ggdc.net/pwt*</a>

![*Source*: PWT (Legend)](images/PWT_GDP.png)

<br>
Which of these three GDP variables, which can be found in the PWT dataset, would be appropriate to use in each of these contexts?

1. To analyse the growth experience of GDP in one country over time.
1. To compare GDP across countries at a given point in time.
1. To compare the evolution of GDP in two or several countries over time.


**Question 2**

1. Before looking at the data, write down a list of up to 20 countries you think are among the richest countries in the world. 
1. Using the data in the PWT, construct a list of the largest economies in terms of output side real GDP in 2019.
1. Using the data in the PWT, construct a list of the largest economies in terms of output side real GDP *per capita* in 2019.
1. How do the ranks of Nigeria, China and Norway differ in the two lists? How do you explain the differences?

**Question 3**

Consider four GDP measures than can be derived from the PWT data: GDP, GDP per capita, GDP per worker and GDP per hour worked.

1. Explain how you would calculate each of these measures given the data in the PWT.
1. Which of these variables can be used to measure welfare, labour productivity and economic dynamism. What are their limitations?

**Question 4**

Short task / short answer

Compare GDP per capita for a given country using the Maddison database and the PWT. Are there any differences? How can you explain them? What do you get out of this exercise? 

**Question 5**

*Use the National Accounts-based measure of real GDP in the PWT to answer this question*.

1. Calculate the annual growth rates of UK real GDP per worker from 2009 to 2019.    
1. Calculate the trend growth rate of UK real GDP per worker between 2009 and 2019.
1. In which years was the annual growth rate of GDP per worker above trend over this decade?

**Question 6**

Construct plots to compare the growth experience of countries in different region relative a reference country (eg the US). You may look at countries belonging to similar regional areas or sharing similar characteristics (eg resource-rich countries, commonwealth countries, ....)

**Question 7**

Plot UK real GDP using data from the Maddison Project Database since 1252 on a normal scale and a log scale. Based on the comparison of the two plots, why is it useful to represent this series on a log scale?


**Question 8**

<span style="color: blue;">*Coursework*</span>

1. Create a plot of real GDP per hour worked (ie labour productivity) in the UK between 1950 and 2019. [*Hint*: you need to create a new variable]. What happened to UK labour productivity over this period?

1. Create a plot of the logarithm of real GDP per hour worked in the UK. By looking at the plot, can you identify breaks in the trend growth rate of labour productivity (periods when growth slowed down or accelerated)?

1. For each period identified in the previous question, calculate the average annually compounded growth rate of GDP per hour worked and the number years it would take for it to double. Present your results in a table. 

1. Repeat the same exercise for the US. Compare the trends in labour productivity growth in both countries.

1. (Discussion question) What are the implications of the recent trends in labour productivity growth for real wages growth? How do these trends in labour productivity growth differ from those of GDP per capita?


```{r Discussion_section, eval=FALSE, include=FALSE}

## Discussion {-}

1. Trends in GDP and labour productivity as viewed by politicians, the media and the public in general 
- Listen to the recording of the BBC Radio 4 Today Interview of the then Chancellor Jeremy Hunt on the 7^th^ March 2024.
- [FT Data points article (Sept 2023)](https://www.ft.com/content/980cbbe2-0f5d-4330-872d-c7a9d6a97bf6)
1. Should maximising GDP be the aim of governments? What should be the aim of economic policy?
- Simon Kuznets
- [Nature article (Dec 2022)](https://www.nature.com/articles/d41586-022-04412-x)
- Angus Deaton in IMF review (issues on the future of Economics)
1. Culture versus Institutions: What are the origins of the industrial revolution in Europe?
- Joel Mokyr and the "culture" of growth. See also [FT Data points article (Jan 2024)](https://www.ft.com/content/e577411e-3bf2-4fb4-872a-8b7d5e9139d3)
- Acemoglu and Robinson and the role of institutions: the reversal of fortune paper



```


## Appendix: Continuous time notation {-}

**Discrete versus continuous time change**

In this chapter, we have not made much use of the *continuous* time notation, preferring to describe the behaviour of variables in *discrete* time. This reflects the fact that most macroeconomic variables are observed in discrete time. 

In the *discrete* time perspective, variables remain unchanged during the interval between two time periods. In the *continuous* time perspective, variables remain unchanged for an infinitesimally short amount of time. This leads to different ways of expressing the change in these variables. For a more precise definition of these two concepts see [here](https://en.wikipedia.org/wiki/Discrete_time_and_continuous_time).

The *continuous time* change in variable $y$ at $t$ is the *instantaneous change* in $y$ at time $t$. It is defined as the change in variable $y$ between two time periods as the interval of time between these two time periods tends to 0. In other terms, it is the derivative of the variable $y$ with respect to time, denoted $\dot{y}_t$ and defined as:
$$\lim_{\Delta t \rightarrow 0}=\frac{y_t-y_{t-\Delta t}}{\Delta t}=\frac{dy}{dt}=\dot{y}_t$$
In this course, we will formulate economic models using the discrete time notation. The continuous time notation presents analytical advantages and for this reason is often employed in growth models and in textbooks.

**Continuous time growth rate**

The *continuous time* counterpart to the growth rate formula described above is the *instantaneous growth rate* or *proportional change*. The instantaneous growth rate of variable $x$ at time $t$ is calculated as the ratio of the instantaneous change in $x$ and its initial value:
$$g_{t}=\frac{\dot{x}_t}{x_t} $$

**Compounding growth rate**

Assume a variable $y$ (GDP, population, ...) has initial value $y_0$ and grows at the constant rate $g$.
Continuous compounding corresponds to the case where the frequency of compounding ($n$ times a year) becomes infinitely large. Assuming continuous compounding, after $t$ periods its value is equal to:
$$ y_t = \lim_{n\rightarrow \infty} \left(1+\frac{g}{n}\right)^{nt} = e^{gt} y_0$$
where $e = 271828...$ is Euler's number. 

By taking the logarithm of this expression and rearranging, we obtain the following formula for the constant continuous time trend growth rate:
$$ g = \frac{1}{t}\times(\ln{y_t}-\ln{y_0})$$
**Growth rate and logarithm**

Assume a variable $y$ has initial value $y_0$ and grows at the continuously compounded constant rate $g$, ie it follows this process: $y_t = e^{gt} y_0$. Taking the natural logarithm of both sides of the continuous compounding expression and using the rules of logarithms:
$$\ln{y_t}=\ln{e^{gt}}+\ln{y_0}=g\times t + \ln{y_0} = C + g \times t$$
Where $C=\ln{y_0}$ (constant). 

This expression tells us that the *logarithm* of variable $y$ can be expressed as a *linear* function of time $t$. This implies that if a variable is growing at a constant rate, then the plot of its logarithm against time is a straight line. Moreover, the slope of this plot represents the (continuous time) growth rate of this variable. 

